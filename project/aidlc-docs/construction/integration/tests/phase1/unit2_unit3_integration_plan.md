# Unit2 + Unit3 통합 테스트 플랜

## 🎯 테스트 목표

Unit2(카테고리 관리)와 Unit3(카드 생성)의 실제 데이터 연동 및 비즈니스 워크플로우 검증

## 📋 테스트 시나리오

### 1. 기본 워크플로우 테스트

#### 시나리오 1-1: 카테고리 생성 → 카드 생성

```
1. Unit2: 카테고리 "개발 강의" 생성
2. Unit3: YouTube 링크로 카드 생성 시 카테고리 "개발 강의" 선택
3. 검증: 카드가 올바른 카테고리에 저장되었는지 확인
```

#### 시나리오 1-2: 카드 이동 (카테고리 변경)

```
1. Unit3: 기존 카드의 카테고리를 "개발 강의"에서 "취미" 카테고리로 변경
2. 검증: 카테고리 변경이 정상적으로 반영되었는지 확인
```

### 2. 데이터 일관성 테스트

#### 시나리오 2-1: 카테고리 삭제 시 카드 보호

```
1. Unit2: 카드가 있는 카테고리 삭제 시도
2. 검증: 삭제가 차단되고 적절한 오류 메시지 반환
```

#### 시나리오 2-2: 카테고리 삭제 전 카드 이동

```
1. Unit3: 카테고리 A의 모든 카드를 카테고리 B로 이동
2. Unit2: 빈 카테고리 A 삭제
3. 검증: 삭제 성공 및 카드들이 카테고리 B에 정상 존재
```

### 3. 계층 구조 테스트

#### 시나리오 3-1: 계층 카테고리에 카드 생성

```
1. Unit2: "개발" > "프론트엔드" > "React" 3레벨 카테고리 생성
2. Unit3: "React" 카테고리에 카드 생성
3. 검증: 카드가 올바른 계층 경로에 저장
```

#### 시나리오 3-2: 상위 카테고리 삭제 시도

```
1. Unit2: 하위 카테고리와 카드가 있는 상위 카테고리 삭제 시도
2. 검증: 삭제 차단 및 하위 항목 정보 제공
```

### 4. 시스템 카테고리 테스트

#### 시나리오 4-1: 시스템 카테고리 보호

```
1. Unit2: "공유받은카드", "임시" 시스템 카테고리 삭제 시도
2. 검증: 삭제 차단 및 시스템 카테고리 보호 메시지
```

#### 시나리오 4-2: 시스템 카테고리에 카드 저장

```
1. Unit3: "임시" 카테고리에 카드 생성
2. Unit3: "임시" 카테고리의 카드를 일반 카테고리로 이동
3. 검증: 이동 성공 및 데이터 정합성
```

### 5. 동시성 테스트

#### 시나리오 5-1: 동시 카드 생성

```
1. Unit3: 동일 카테고리에 5개 카드 동시 생성
2. 검증: 모든 카드가 정상 생성되고 카테고리 연결 정상
```

#### 시나리오 5-2: 카테고리 수정 중 카드 생성

```
1. Unit2: 카테고리 이름 수정 중
2. Unit3: 동시에 해당 카테고리에 카드 생성
3. 검증: 데이터 일관성 및 트랜잭션 처리
```

## 🔍 검증 항목

### API 응답 검증

- [ ] 표준 응답 형식 준수 (Integration Contract)
- [ ] 적절한 HTTP 상태 코드 반환
- [ ] 오류 메시지의 명확성 및 일관성

### 데이터베이스 검증

- [ ] 외래키 제약조건 정상 동작
- [ ] 트랜잭션 롤백 시 데이터 일관성
- [ ] 인덱스 성능 및 쿼리 최적화

### 비즈니스 로직 검증

- [ ] 카테고리-카드 연관관계 정확성
- [ ] 계층 구조 제약사항 준수
- [ ] 시스템 카테고리 보호 규칙

## 📊 성능 기준

- API 응답시간: < 200ms
- 동시 요청 처리: 50개 요청/초
- 데이터 일관성: 100%

## 🛠️ 테스트 도구

- **API 테스트**: httpx (Python)
- **데이터베이스 검증**: 직접 SQL 쿼리
- **동시성 테스트**: asyncio 기반 병렬 요청

## ❓ 질문사항

### 1. 카테고리-카드 연관관계

**Q1**: Unit3에서 카드 생성 시 카테고리 ID를 어떻게 전달받나요?

- 카드 생성 API의 request body에 category_id 필드가 있나요? 있어.
- 카테고리 선택은 프론트엔드에서 처리하고 백엔드는 ID만 받나요? 그렇지.

**Q2**: 카드가 카테고리 없이 생성될 수 있나요?

- 카테고리 미선택 시 기본 카테고리(예: "미분류")로 자동 할당되나요?
- 아니면 카테고리 선택이 필수인가요? 필수야.

### 2. 데이터 일관성 처리

**Q3**: 카테고리 삭제 시 카드 처리 방식은?

- 카드가 있는 카테고리 삭제를 완전히 차단하나요?
- 아니면 카드를 다른 카테고리로 자동 이동 후 삭제하나요? 자동 이동은 아니고 사용자 선택해서 이동이야. 사용자가 임의의 카테고리를 선택하거나 "임시"카테고리로 이동시킬 수 있어.

**Q4**: 트랜잭션 범위는 어디까지인가요?

- Unit2와 Unit3가 같은 데이터베이스를 사용하므로 분산 트랜잭션이 필요한가요?
- 아니면 각 Unit에서 독립적으로 트랜잭션을 관리하나요?

### 3. API 통신 방식

**Q5**: Unit2와 Unit3 간 직접 API 호출이 있나요?

- Unit3에서 카테고리 정보가 필요할 때 Unit2 API를 직접 호출하나요?
- 아니면 프론트엔드에서 각각 호출해서 조합하나요?

**Q6**: 카테고리 변경 시 알림 처리는?

- Unit2에서 카테고리가 변경되면 Unit3에 알림을 보내나요?
- 이벤트 기반 통신이 구현되어 있나요?

### 4. 오류 처리

**Q7**: 존재하지 않는 카테고리 ID로 카드 생성 시도 시?

- 400 Bad Request를 반환하나요?
- 404 Not Found를 반환하나요?
- 기본 카테고리로 자동 할당하나요?

**Q8**: 카테고리 삭제 차단 시 응답 형식은?

- 어떤 HTTP 상태 코드를 사용하나요? (400? 409?)
- 오류 메시지에 관련 카드 개수 정보를 포함하나요?

### 5. 테스트 데이터

**Q9**: 테스트용 YouTube 링크는?

- 실제 YouTube API를 호출해야 하나요?
- 테스트용 Mock 데이터를 사용할 수 있나요?

**Q10**: 사용자 인증은?

- 테스트 시 실제 JWT 토큰이 필요한가요?
- 테스트용 사용자 계정이 미리 생성되어 있나요?

## 📝 테스트 실행 순서

1. 환경 설정 및 테스트 데이터 준비
2. 기본 워크플로우 테스트 (시나리오 1)
3. 데이터 일관성 테스트 (시나리오 2)
4. 계층 구조 테스트 (시나리오 3)
5. 시스템 카테고리 테스트 (시나리오 4)
6. 동시성 테스트 (시나리오 5)
7. 성능 측정 및 결과 분석
8. 테스트 환경 정리

이 질문들에 대한 답변을 받은 후 구체적인 테스트 코드를 작성하겠습니다.
